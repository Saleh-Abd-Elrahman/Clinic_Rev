{% extends "base.html" %}

{% block content %}
<div class="review-page">
    <h1>üåü Your Review</h1>
    
    <div class="review-content">
        <div class="review-text">
            {{ review_text }}
        </div>
        
        <div class="review-actions">
            <button id="copy-and-open-btn" class="copy-open-btn">
                üåü Copy Review & Open Google Reviews
            </button>
            
            <div id="status-message" class="status-message"></div>
        </div>
    </div>
</div>

{% block scripts %}
<script>
document.getElementById('copy-and-open-btn').addEventListener('click', async function() {
    const reviewText = `{{ review_text|safe }}`;
    const statusMessage = document.getElementById('status-message');
    
    try {
        // Copy to clipboard
        await navigator.clipboard.writeText(reviewText);
        statusMessage.textContent = '‚úÖ Review copied to clipboard!';
        statusMessage.style.color = 'green';
        
        // Open Google Reviews after a short delay
        setTimeout(() => {
            window.open('https://www.google.com/search?q=google+reviews', '_blank');
        }, 500);
        
    } catch (error) {
        console.error('Failed to copy text: ', error);
        statusMessage.textContent = '‚ùå Failed to copy. Please select and copy the text manually.';
        statusMessage.style.color = 'red';
        
        // Fallback: select the text
        const reviewTextElement = document.querySelector('.review-text');
        if (reviewTextElement) {
            const range = document.createRange();
            range.selectNode(reviewTextElement);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
        }
    }
});
</script>
{% endblock %}
{% endblock %} 