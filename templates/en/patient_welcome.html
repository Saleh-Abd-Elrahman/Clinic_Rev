{% extends "base.html" %}

{% block content %}
<div class="background" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -1; overflow: hidden;">
  <div class="glow pink"></div>
  <div class="glow wine"></div>
</div>

<div class="toggle-wrapper">
  <label class="switch">
    <input type="checkbox" id="darkToggle">
    <span class="slider"></span>
  </label>
</div>

<h1 class="title-color">ðŸŒ¸ Welcome, {{ patient_name }}!</h1>
  
  <div class="glass-box">
    <div class="emoji">ðŸ’–</div>
    <p class="message">
      {{ welcome_message }}
    </p>
  </div>
  <p class="subtext">Weâ€™d love your feedback to keep improving.</p>

  <form method="get" action="/patient-survey" id="continue-form">
    <input type="hidden" name="session_data" value="{{ session_data|e }}">
    <button type="submit" class="btn-primary">Start Quick Feedback</button>
  </form>
<script>
document.addEventListener('DOMContentLoaded', function() {
  document.getElementById('darkToggle').addEventListener('change', function() {
    document.body.classList.toggle('dark');
  });

  // Store session
  const data = {{ session_data|tojson|safe }};
  sessionStorage.setItem("patientSessionData", JSON.stringify(data));

  let timeout = setTimeout(() => {
    document.getElementById('continue-form').submit();
  }, 5000);

  document.addEventListener('click', () => clearTimeout(timeout));
  document.addEventListener('keydown', () => clearTimeout(timeout));
});
</script>
{% endblock %}